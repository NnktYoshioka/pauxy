#!/usr/bin/env python

import sys
import afqmcpy.cpmc
import afqmcpy.calc
import json

def main(input_file):
    (options, comm) = afqmcpy.calc.init(input_file)
    if comm is not None:
        cpmc = afqmcpy.calc.setup_parallel(options, comm)
    else:
        cpmc = afqmcpy.cpmc.CPMC(options.get('model'),
                                 options.get('qmc_options'),
                                 options.get('estimates'),
                                 options.get('trial_wavefunction'))
    cpmc.run(comm=comm)

if __name__ == '__main__':
    main(sys.argv[1])
